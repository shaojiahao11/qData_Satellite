<template>
  <div class="editor-warp">
    <div class="sideConfig">
      <div class="icon" :class="{ act: activeValue.name == item.name }" v-for="item in iconList" :key="item"
        @click="handleIcon(item)" :title="item.name">
        <el-icon>
          <component :is="item.icon" />
        </el-icon>
      </div>
    </div>
    <div class="editor-con" :style="`width: calc(100% - ${configWidth}px);`">
      <div class="editor-main" ref="editorMain" :style="`height: calc(100% - ${consoleHeight}px);`">
        <Editor ref="editorRef" :model-value="props.value" @update:model-value="handleChange" />
        <div class="full-screen" :title="isFullscreen ? '退出全屏' : '全屏'" @click="fullScreenCallBack">
          <i :class="isFullscreen ? 'iconfont icon-fullscreen-exit-line' : 'iconfont icon-a-quanpingxianxing'"
            style="font-size: 20px"></i>
        </div>
      </div>
      <Console ref="consoleRef" :currValue="activeValue" @close="closeConsoleDialog" v-if="activeValue.type" />
    </div>
    <ConfigView ref="configViewRef" :configValue="activeValueR" @close="closeConsoleDialogR" v-if="activeValueR.type" />
    <div class="sideConfig sideConfig-r">
      <div class="icon" :class="{ act: activeValueR.name == item.name }" v-for="item in iconListR" :key="item"
        @click="handleIconR(item)" :title="item.name">
        <el-icon>
          <component :is="item.icon" />
        </el-icon>
      </div>
    </div>
  </div>
</template>
<script setup>
import { useFullscreen } from "@vueuse/core";
import Console from "./console";
import Editor from "./editor";
import ConfigView from "./configView";
// editor数据
const props = defineProps({
  value: {
    type: String,
    default: "",
  },
  configValue: {
    type: Object,
    default: () => ({}),
  },
});
const emits = defineEmits(["handleChange"]);

// 左侧图标
const iconList = ref([
  {
    name: "日志控制台",
    type: "console",
    icon: "FolderChecked",
    data: [
      {
        label: "FlinkSubmit",
        log: "Start Process:FlinkSubmit/4\nStart Process Step:SUBMIT_PRECHECK\n2025-06-18 15:23:10.204 INFO  org.dinky.service.impl.TaskServiceImpl(180): Start check and config task, task:mysql-oracle\nProcess Step SUBMIT_PRECHECK exit with status:FINISHED\nStart Process Step:SUBMIT_EXECUTE\nStart Process Step:SUBMIT_BUILD_CONFIG\n2025-06-18 15:23:10.211 INFO  org.dinky.service.impl.TaskServiceImpl(289): Start initialize FlinkSQLEnv:\n2025-06-18 15:23:10.212 INFO  org.dinky.service.impl.TaskServiceImpl(309): Initializing data permissions...\n2025-06-18 15:23:10.358 INFO  org.dinky.service.impl.TaskServiceImpl(311): Finish initialize FlinkSQLEnv.\n2025-06-18 15:23:10.362 INFO  org.dinky.service.impl.TaskServiceImpl(239): Init remote cluster\nProcess Step SUBMIT_BUILD_CONFIG exit with status:FINISHED\n2025-06-18 15:23:11.491 INFO  org.dinky.service.task.FlinkSqlTask(67): Initializing Flink job config...\n2025-06-18 15:23:11.803 INFO  org.reflections.Reflections(219): Reflections took 14 ms to scan 2 urls, producing 8 keys and 33 values\n2025-06-18 15:23:11.874 INFO  org.dinky.job.builder.JobUDFBuilder(129): A total of 0 UDF have been Init.\n2025-06-18 15:23:11.874 INFO  org.dinky.job.builder.JobUDFBuilder(130): Initializing Flink UDF...Finish\n2025-06-18 15:23:11.876 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:11.956 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:12.019 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:12.020 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:12.187 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(37): Print mysql-cdc connector configuration:\n2025-06-18 15:23:12.188 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): hostname = 60.205.169.125\n2025-06-18 15:23:12.188 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): password = ******\n2025-06-18 15:23:12.189 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): debezium.snapshot.mode = latest-offset\n2025-06-18 15:23:12.189 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): scan.incremental.snapshot.enabled = true\n2025-06-18 15:23:12.189 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): connector = mysql-cdc\n2025-06-18 15:23:12.190 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): port = 3306\n2025-06-18 15:23:12.190 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): database-name = test\n2025-06-18 15:23:12.190 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): server-time-zone = Asia/Shanghai\n2025-06-18 15:23:12.191 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): table-name = table1\n2025-06-18 15:23:12.191 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): username = root\n2025-06-18 15:23:14.229 INFO  org.apache.flink.configuration.Configuration(863): Config uses fallback configuration key 'rest.port' instead of key 'rest.bind-port'\n2025-06-18 15:23:14.234 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.cpu.cores required for local execution is not set, setting it to the maximal possible value.\n2025-06-18 15:23:14.234 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.task.heap.size required for local execution is not set, setting it to the maximal possible value.\n2025-06-18 15:23:14.234 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.task.off-heap.size required for local execution is not set, setting it to the maximal possible value.\n2025-06-18 15:23:14.235 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.network.min required for local execution is not set, setting it to its default value 64 mb.\n2025-06-18 15:23:14.236 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.network.max required for local execution is not set, setting it to its default value 64 mb.\n2025-06-18 15:23:14.236 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.managed.size required for local execution is not set, setting it to its default value 128 mb.\n2025-06-18 15:23:14.242 INFO  org.apache.flink.runtime.minicluster.MiniCluster(322): Starting Flink Mini Cluster\n2025-06-18 15:23:14.622 INFO  org.apache.flink.runtime.minicluster.MiniCluster(341): Starting Metrics Registry\n2025-06-18 15:23:14.691 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl(142): No metrics reporter configured, no metrics will be exposed/reported.\n2025-06-18 15:23:14.691 INFO  org.apache.flink.runtime.minicluster.MiniCluster(348): Starting RPC Service(s)\n2025-06-18 15:23:14.705 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(225): Trying to start local actor system\n2025-06-18 15:23:14.968 INFO  akka.event.slf4j.Slf4jLogger(107): Slf4jLogger started\n2025-06-18 15:23:15.045 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(255): Actor system started at akka://flink\n2025-06-18 15:23:15.056 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(225): Trying to start local actor system\n2025-06-18 15:23:15.064 INFO  akka.event.slf4j.Slf4jLogger(107): Slf4jLogger started\n2025-06-18 15:23:15.071 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(255): Actor system started at akka://flink-metrics\n2025-06-18 15:23:15.084 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.metrics.dump.MetricQueryService at akka://flink-metrics/user/rpc/MetricQueryService .\n2025-06-18 15:23:15.103 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(127): Loading delegation token providers\n2025-06-18 15:23:15.109 INFO  org.apache.flink.runtime.security.token.hadoop.HadoopFSDelegationTokenProvider(76): Hadoop FS is not available (not packaged with this application): NoClassDefFoundError : \"org/apache/hadoop/io/Text\".\n2025-06-18 15:23:15.109 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(135): Delegation token provider hadoopfs loaded and initialized\n2025-06-18 15:23:15.112 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(135): Delegation token provider hbase loaded and initialized\n2025-06-18 15:23:15.112 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(165): Delegation token providers loaded successfully\n2025-06-18 15:23:15.113 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(64): Loading delegation token receivers\n2025-06-18 15:23:15.116 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hadoopfs loaded and initialized\n2025-06-18 15:23:15.117 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hbase loaded and initialized\n2025-06-18 15:23:15.118 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(101): Delegation token receivers loaded successfully\n2025-06-18 15:23:15.118 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(189): Checking provider and receiver instances consistency\n2025-06-18 15:23:15.118 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(209): Provider and receiver instances are consistent\n2025-06-18 15:23:15.119 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(240): Obtaining delegation tokens\n2025-06-18 15:23:15.121 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(243): Delegation tokens obtained successfully\n2025-06-18 15:23:15.121 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(248): No tokens obtained so skipping notifications\n2025-06-18 15:23:15.121 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(64): Loading delegation token receivers\n2025-06-18 15:23:15.122 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hadoopfs loaded and initialized\n2025-06-18 15:23:15.122 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hbase loaded and initialized\n2025-06-18 15:23:15.123 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(101): Delegation token receivers loaded successfully\n2025-06-18 15:23:15.138 INFO  org.apache.flink.runtime.blob.BlobServer(164): Created BLOB server storage directory /tmp/minicluster_6ea368b166941778804d7ea99cda8bee/blobStorage\n2025-06-18 15:23:15.144 INFO  org.apache.flink.runtime.blob.BlobServer(238): Started BLOB server at 0.0.0.0:38403 - max concurrent requests: 50 - max backlog: 1000\n2025-06-18 15:23:15.154 INFO  org.apache.flink.runtime.blob.PermanentBlobCache(93): Created BLOB cache storage directory /tmp/minicluster_6ea368b166941778804d7ea99cda8bee/blobStorage\n2025-06-18 15:23:15.156 INFO  org.apache.flink.runtime.blob.TransientBlobCache(93): Created BLOB cache storage directory /tmp/minicluster_6ea368b166941778804d7ea99cda8bee/blobStorage\n2025-06-18 15:23:15.158 INFO  org.apache.flink.runtime.minicluster.MiniCluster(733): Starting 1 TaskManager(s)\n2025-06-18 15:23:15.165 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner(602): Starting TaskManager with ResourceID: cf6da506-08d4-44c5-b9cb-331b1c08c49b\n2025-06-18 15:23:15.173 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerServices(487): Temporary file directory '/tmp': total 1006 GB, usable 873 GB (86.78% usable)\n2025-06-18 15:23:15.179 INFO  org.apache.flink.runtime.io.disk.iomanager.IOManager(60): Created a new FileChannelManager for spilling of task related data to disk (joins, sorting, ...). Used directories:\n\t/tmp/flink-io-c33942cc-8673-4fb9-a126-b08b0ea68403\n2025-06-18 15:23:15.193 INFO  org.apache.flink.runtime.io.network.NettyShuffleServiceFactory(161): Created a new FileChannelManager for storing result partitions of BLOCKING shuffles. Used directories:\n\t/tmp/flink-netty-shuffle-4b569fb8-e7be-4654-9f61-65d62f536719\n2025-06-18 15:23:15.238 INFO  org.apache.flink.runtime.io.network.buffer.NetworkBufferPool(156): Allocated 64 MB for network buffer pool (number of memory segments: 2048, bytes per segment: 32768).\n2025-06-18 15:23:15.253 INFO  org.apache.flink.runtime.io.network.NettyShuffleEnvironment(353): Starting the network environment and its components.\n2025-06-18 15:23:15.256 INFO  org.apache.flink.runtime.taskexecutor.KvStateService(92): Starting the kvState service and its components.\n2025-06-18 15:23:15.276 INFO  org.apache.flink.configuration.Configuration(863): Config uses fallback configuration key 'akka.ask.timeout' instead of key 'taskmanager.slot.timeout'\n2025-06-18 15:23:15.287 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.taskexecutor.TaskExecutor at akka://flink/user/rpc/taskmanager_0 .\n2025-06-18 15:23:15.307 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(127): Start job leader service.\n2025-06-18 15:23:15.309 INFO  org.apache.flink.runtime.filecache.FileCache(116): User file cache uses directory /tmp/flink-dist-cache-851319e4-106f-438e-b90f-2dc5a79c3213\n2025-06-18 15:23:15.338 INFO  org.apache.flink.configuration.Configuration(863): Config uses fallback configuration key 'rest.port' instead of key 'rest.bind-port'\n2025-06-18 15:23:15.361 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(180): Starting rest endpoint.\n2025-06-18 15:23:15.475 WARN  org.apache.flink.runtime.webmonitor.WebMonitorUtils(76): Log file environment variable 'log.file' is not set.\n2025-06-18 15:23:15.475 WARN  org.apache.flink.runtime.webmonitor.WebMonitorUtils(82): JobManager log files are unavailable in the web dashboard. Log file location not found in environment variable 'log.file' or configuration key 'web.log.path'.\n2025-06-18 15:23:15.631 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(303): Rest endpoint listening at localhost:35792\n2025-06-18 15:23:15.632 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender http://localhost:35792\n2025-06-18 15:23:15.633 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(1034): Web frontend listening at http://localhost:35792.\n2025-06-18 15:23:15.634 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(1092): http://localhost:35792 was granted leadership with leaderSessionID=38eb3cd0-3a2c-44fd-93ec-ddbceb769114\n2025-06-18 15:23:15.634 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader http://localhost:35792 , session=38eb3cd0-3a2c-44fd-93ec-ddbceb769114\n2025-06-18 15:23:15.651 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender LeaderContender: DefaultDispatcherRunner\n2025-06-18 15:23:15.651 INFO  org.apache.flink.runtime.resourcemanager.ResourceManagerServiceImpl(119): Starting resource manager service.\n2025-06-18 15:23:15.652 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender LeaderContender: ResourceManagerServiceImpl\n2025-06-18 15:23:15.652 INFO  org.apache.flink.runtime.dispatcher.runner.DefaultDispatcherRunner(114): DefaultDispatcherRunner was granted leadership with leader id fffeca58-a7e4-4887-94a8-c2ae5b0835d6. Creating new DispatcherLeaderProcess.\n2025-06-18 15:23:15.653 INFO  org.apache.flink.runtime.resourcemanager.ResourceManagerServiceImpl(199): Resource manager service is granted leadership with session id cb9f97ca-e940-436e-a402-89b202ad4568.\n2025-06-18 15:23:15.656 INFO  org.apache.flink.runtime.minicluster.MiniCluster(508): Flink Mini Cluster started successfully\n2025-06-18 15:23:15.659 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess(99): Start SessionDispatcherLeaderProcess.\n2025-06-18 15:23:15.662 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess(144): Recover all persisted job graphs that are not finished, yet.\n2025-06-18 15:23:15.663 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess(158): Successfully recovered 0 persisted job graphs.\n2025-06-18 15:23:15.678 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.resourcemanager.StandaloneResourceManager at akka://flink/user/rpc/resourcemanager_1 .\n2025-06-18 15:23:15.678 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.dispatcher.StandaloneDispatcher at akka://flink/user/rpc/dispatcher_2 .\n2025-06-18 15:23:15.697 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(251): Starting the resource manager.\n2025-06-18 15:23:15.717 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader akka://flink/user/rpc/dispatcher_2 , session=fffeca58-a7e4-4887-94a8-c2ae5b0835d6\n2025-06-18 15:23:15.718 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(308): Starting tokens update task\n2025-06-18 15:23:15.718 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(320): No tokens obtained so skipping notifications\n2025-06-18 15:23:15.719 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(335): Tokens update task not started because either no tokens obtained or none of the tokens specified its renewal date\n2025-06-18 15:23:15.719 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader akka://flink/user/rpc/resourcemanager_1 , session=cb9f97ca-e940-436e-a402-89b202ad4568\n2025-06-18 15:23:15.721 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1416): Connecting to ResourceManager akka://flink/user/rpc/resourcemanager_1(a40289b202ad4568cb9f97cae940436e).\n2025-06-18 15:23:15.733 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(162): Resolved ResourceManager address, beginning registration\n2025-06-18 15:23:15.741 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(1033): Registering TaskManager with ResourceID cf6da506-08d4-44c5-b9cb-331b1c08c49b (akka://flink/user/rpc/taskmanager_0) at ResourceManager\n2025-06-18 15:23:15.745 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher(496): Received JobGraph submission 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.746 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher(599): Submitting job 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.746 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(99): Successful registration at resource manager akka://flink/user/rpc/resourcemanager_1 under registration id 72221bca282229cac5ead84d160b54b9.\n2025-06-18 15:23:15.766 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender LeaderContender: JobMasterServiceLeadershipRunner\n2025-06-18 15:23:15.767 INFO  org.apache.flink.runtime.jobmaster.JobMasterServiceLeadershipRunner(310): JobMasterServiceLeadershipRunner for job d684d51546251379fbbe534b66ccca2a was granted leadership with leader id 646f0693-74e7-4ed6-86ad-569966a034b0. Creating new JobMasterServiceProcess.\n2025-06-18 15:23:15.782 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.jobmaster.JobMaster at akka://flink/user/rpc/jobmanager_3 .\n2025-06-18 15:23:15.792 INFO  org.apache.flink.runtime.jobmaster.JobMaster(314): Initializing job 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.826 INFO  org.apache.flink.runtime.jobmaster.JobMaster(103): Using restart back off time strategy NoRestartBackoffTimeStrategy for mysql-oracle (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.872 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(406): Created execution graph 171ab47548f91c2f2151721d23b39dfc for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:15.903 INFO  org.apache.flink.runtime.jobmaster.JobMaster(165): Running initialization on master for job mysql-oracle (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.904 INFO  org.apache.flink.runtime.jobmaster.JobMaster(194): Successfully ran initialization on master in 1 ms.\n2025-06-18 15:23:15.955 INFO  org.apache.flink.runtime.scheduler.adapter.DefaultExecutionTopology(416): Built 1 new pipelined regions in 2 ms, total 1 pipelined regions currently.\n2025-06-18 15:23:15.961 INFO  org.apache.flink.runtime.jobmaster.JobMaster(263): No state backend has been configured, using default (HashMap) org.apache.flink.runtime.state.hashmap.HashMapStateBackend@2d711b25\n2025-06-18 15:23:15.962 INFO  org.apache.flink.runtime.state.StateBackendLoader(321): State backend loader loads the state backend as HashMapStateBackend\n2025-06-18 15:23:15.964 INFO  org.apache.flink.runtime.jobmaster.JobMaster(274): Checkpoint storage is set to 'jobmanager'\n2025-06-18 15:23:16.001 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator(1706): No checkpoint found during restore.\n2025-06-18 15:23:16.014 INFO  org.apache.flink.runtime.jobmaster.JobMaster(164): Using failover strategy org.apache.flink.runtime.executiongraph.failover.flip1.RestartPipelinedRegionFailoverStrategy@6e785df6 for mysql-oracle (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:16.027 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader akka://flink/user/rpc/jobmanager_3 , session=646f0693-74e7-4ed6-86ad-569966a034b0\n2025-06-18 15:23:16.031 INFO  org.apache.flink.runtime.jobmaster.JobMaster(955): Starting execution of job 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a) under job master id 86ad569966a034b0646f069374e74ed6.\n2025-06-18 15:23:16.035 INFO  org.apache.flink.runtime.source.coordinator.SourceCoordinator(201): Starting split enumerator for source Source: table1[1].\n2025-06-18 15:23:16.052 INFO  org.apache.flink.cdc.connectors.mysql.source.connection.JdbcConnectionPools(49): Create and register connection pool root@60.205.169.125:3306\n2025-06-18 15:23:16.060 INFO  org.apache.flink.cdc.connectors.shaded.com.zaxxer.hikari.HikariDataSource(80): connection-pool-60.205.169.125:3306 - Starting...\n2025-06-18 15:23:16.403 INFO  org.apache.flink.cdc.connectors.shaded.com.zaxxer.hikari.HikariDataSource(82): connection-pool-60.205.169.125:3306 - Start completed.\n2025-06-18 15:23:16.527 INFO  io.debezium.jdbc.JdbcConnection(962): Connection gracefully closed\n2025-06-18 15:23:16.528 INFO  org.apache.flink.cdc.connectors.mysql.MySqlValidator(81): MySQL validation passed.\n2025-06-18 15:23:16.624 INFO  io.debezium.jdbc.JdbcConnection(962): Connection gracefully closed\n2025-06-18 15:23:16.628 INFO  org.apache.flink.runtime.jobmaster.JobMaster(212): Starting scheduling with scheduling strategy [org.apache.flink.runtime.scheduler.strategy.PipelinedRegionSchedulingStrategy]\n2025-06-18 15:23:16.628 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1165): Job mysql-oracle (d684d51546251379fbbe534b66ccca2a) switched from state CREATED to RUNNING.\n2025-06-18 15:23:16.632 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to SCHEDULED.\n2025-06-18 15:23:16.653 INFO  org.apache.flink.runtime.jobmaster.JobMaster(1150): Connecting to ResourceManager akka://flink/user/rpc/resourcemanager_1(a40289b202ad4568cb9f97cae940436e)\n2025-06-18 15:23:16.656 INFO  org.apache.flink.runtime.jobmaster.JobMaster(162): Resolved ResourceManager address, beginning registration\n2025-06-18 15:23:16.658 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(388): Registering job manager 86ad569966a034b0646f069374e74ed6@akka://flink/user/rpc/jobmanager_3 for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.662 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(968): Registered job manager 86ad569966a034b0646f069374e74ed6@akka://flink/user/rpc/jobmanager_3 for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.663 INFO  org.apache.flink.runtime.jobmaster.JobMaster(1174): JobManager successfully registered at ResourceManager, leader id: a40289b202ad4568cb9f97cae940436e.\n2025-06-18 15:23:16.666 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DeclarativeSlotManager(295): Received resource requirements from job d684d51546251379fbbe534b66ccca2a: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]\n2025-06-18 15:23:16.704 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(52): Read list of available databases\n2025-06-18 15:23:16.726 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(65): \t list of available databases is: [test]\n2025-06-18 15:23:16.727 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(74): Read list of available tables in each database\n2025-06-18 15:23:16.734 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1113): Receive slot request a46332115ff2d6c1e1e2b1577664e424 for job d684d51546251379fbbe534b66ccca2a from resource manager with leader id a40289b202ad4568cb9f97cae940436e.\n2025-06-18 15:23:16.741 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1208): Allocated slot for a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.744 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(192): Add job d684d51546251379fbbe534b66ccca2a for job leader monitoring.\n2025-06-18 15:23:16.746 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(86): \t including table 'test.table1' for further processing\n2025-06-18 15:23:16.746 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(90): \t 'test.table2' is filtered out of table capturing\n2025-06-18 15:23:16.746 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(90): \t 'test.table3' is filtered out of table capturing\n2025-06-18 15:23:16.747 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(90): \t 'test.table4' is filtered out of table capturing\n2025-06-18 15:23:16.747 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(350): Try to register at job manager akka://flink/user/rpc/jobmanager_3 with leader id 646f0693-74e7-4ed6-86ad-569966a034b0.\n2025-06-18 15:23:16.749 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(162): Resolved JobManager address, beginning registration\n2025-06-18 15:23:16.755 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(417): Successful registration at job manager akka://flink/user/rpc/jobmanager_3 for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.756 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1720): Establish JobManager connection for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.762 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1571): Offer reserved slots to the leader of job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.769 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from SCHEDULED to DEPLOYING.\n2025-06-18 15:23:16.770 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(561): Deploying Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (attempt #0) with attempt id 171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to cf6da506-08d4-44c5-b9cb-331b1c08c49b @ localhost (dataPort=-1) with allocation id a46332115ff2d6c1e1e2b1577664e424\n2025-06-18 15:23:16.777 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl(388): Activate slot a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.791 INFO  io.debezium.jdbc.JdbcConnection(962): Connection gracefully closed\n2025-06-18 15:23:16.793 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlSnapshotSplitAssigner(297): Start splitting table test.table1 into chunks...\n2025-06-18 15:23:16.796 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader(84): StateChangelogStorageLoader initialized with shortcut names {memory,filesystem}.\n2025-06-18 15:23:16.796 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader(106): Creating a changelog storage with name 'memory'.\n2025-06-18 15:23:16.813 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager(70): Creating the channel state executor factory for job id d684d51546251379fbbe534b66ccca2a\n2025-06-18 15:23:16.827 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(789): Received task Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0), deploy into slot with allocation id a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.829 INFO  org.apache.flink.runtime.taskmanager.Task(1084): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to DEPLOYING.\n2025-06-18 15:23:16.831 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl(388): Activate slot a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.834 INFO  org.apache.flink.runtime.taskmanager.Task(622): Loading JAR files for task Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) [DEPLOYING].\n2025-06-18 15:23:16.858 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask(263): No state backend has been configured, using default (HashMap) org.apache.flink.runtime.state.hashmap.HashMapStateBackend@6bba90d4\n2025-06-18 15:23:16.859 INFO  org.apache.flink.runtime.state.StateBackendLoader(321): State backend loader loads the state backend as HashMapStateBackend\n2025-06-18 15:23:16.859 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask(274): Checkpoint storage is set to 'jobmanager'\n2025-06-18 15:23:16.872 INFO  org.apache.flink.runtime.taskmanager.Task(1084): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.\n2025-06-18 15:23:16.875 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.\n2025-06-18 15:23:17.481 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlChunkSplitter(165): Use unevenly-sized chunks for table test.table1, the chunk size is 8096 from null\n2025-06-18 15:23:17.609 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlChunkSplitter(470): ChunkSplitter has split 0 chunks for table test.table1\n2025-06-18 15:23:17.610 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlSnapshotSplitAssigner(331): Split table test.table1 into 1 chunks, time cost: 817ms.\n2025-06-18 15:23:17.912 INFO  org.apache.flink.runtime.source.coordinator.SourceCoordinator(594): Source Source: table1[1] registering reader for parallel task 0 (#0) @ \n2025-06-18 15:23:17.914 INFO  org.apache.flink.runtime.source.coordinator.SourceCoordinator(555): Source Source: table1[1] received split request from parallel task 0 (#0)\n2025-06-18 15:23:17.915 INFO  org.apache.flink.runtime.taskmanager.Task(1084): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to RUNNING.\n2025-06-18 15:23:17.915 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to RUNNING.\n2025-06-18 15:23:17.945 INFO  org.apache.flink.cdc.connectors.mysql.source.enumerator.MySqlSourceEnumerator(229): The enumerator assigns split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null} to subtask 0\n2025-06-18 15:23:17.967 INFO  org.apache.flink.cdc.connectors.mysql.source.reader.MySqlSourceReader(235): Source reader 0 adds split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}\n2025-06-18 15:23:17.967 INFO  org.apache.flink.connector.base.source.reader.SourceReaderBase(235): Adding split(s) to reader: [MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}]\n2025-06-18 15:23:17.973 INFO  org.apache.flink.connector.base.source.reader.fetcher.SplitFetcher(112): Starting split fetcher 0\n2025-06-18 15:23:17.974 INFO  org.apache.flink.cdc.connectors.mysql.source.reader.MySqlSplitReader(215): Handling split change SplitAddition:[[MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}]]\n2025-06-18 15:23:17.979 WARN  io.debezium.connector.mysql.MySqlConnection(643): Database configuration option 'serverTimezone' is set but is obsolete, please use 'connectionTimeZone' instead\n2025-06-18 15:23:18.194 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.context.StatefulTaskContext(200): Starting offset is initialized to {ts_sec=0, file=, pos=0, kind=EARLIEST, row=0, event=0}\n2025-06-18 15:23:18.279 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(157): Snapshot step 1 - Determining low watermark {ts_sec=0, file=mysql-bin.000044, pos=154, kind=SPECIFIC, gtids=, row=0, event=0} for split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}\n2025-06-18 15:23:18.284 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(170): Snapshot step 2 - Snapshotting data\n2025-06-18 15:23:18.284 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(243): Exporting data from split 'test.table1:0' of table test.table1\n2025-06-18 15:23:18.284 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(251): For split 'test.table1:0' of table test.table1 using select statement: 'SELECT * FROM `test`.`table1`'\n2025-06-18 15:23:18.333 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(298): Finished exporting 2 records for split 'test.table1:0', total duration '00:00:00.049'\n2025-06-18 15:23:18.354 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(192): Snapshot step 3 - Determining high watermark {ts_sec=0, file=mysql-bin.000044, pos=154, kind=SPECIFIC, gtids=, row=0, event=0} for split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}\n2025-06-18 15:23:18.490 INFO  org.dinky.service.impl.TaskServiceImpl(195): execute job finished,status is SUCCESS\nProcess Step SUBMIT_EXECUTE exit with status:FINISHED\n2025-06-18 15:23:18.493 INFO  org.dinky.service.impl.TaskServiceImpl(326): Job Submit success\n",
        children: [
          {
            label: "检查作业",
            log: "Start Process Step:SUBMIT_PRECHECK\n2025-06-18 15:23:10.204 INFO  org.dinky.service.impl.TaskServiceImpl(180): Start check and config task, task:mysql-oracle\nProcess Step SUBMIT_PRECHECK exit with status:FINISHED\n",
          },
          {
            label: "执行作业",
            log: "Start Process Step:SUBMIT_EXECUTE\n2025-06-18 15:23:11.491 INFO  org.dinky.service.task.FlinkSqlTask(67): Initializing Flink job config...\n2025-06-18 15:23:11.803 INFO  org.reflections.Reflections(219): Reflections took 14 ms to scan 2 urls, producing 8 keys and 33 values\n2025-06-18 15:23:11.874 INFO  org.dinky.job.builder.JobUDFBuilder(129): A total of 0 UDF have been Init.\n2025-06-18 15:23:11.874 INFO  org.dinky.job.builder.JobUDFBuilder(130): Initializing Flink UDF...Finish\n2025-06-18 15:23:11.876 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:11.956 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:12.019 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:12.020 INFO  org.dinky.utils.KerberosUtil(58): Simple authentication mode\n2025-06-18 15:23:12.187 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(37): Print mysql-cdc connector configuration:\n2025-06-18 15:23:12.188 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): hostname = 60.205.169.125\n2025-06-18 15:23:12.188 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): password = ******\n2025-06-18 15:23:12.189 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): debezium.snapshot.mode = latest-offset\n2025-06-18 15:23:12.189 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): scan.incremental.snapshot.enabled = true\n2025-06-18 15:23:12.189 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): connector = mysql-cdc\n2025-06-18 15:23:12.190 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): port = 3306\n2025-06-18 15:23:12.190 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): database-name = test\n2025-06-18 15:23:12.190 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): server-time-zone = Asia/Shanghai\n2025-06-18 15:23:12.191 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): table-name = table1\n2025-06-18 15:23:12.191 INFO  org.apache.flink.cdc.connectors.mysql.utils.OptionUtils(39): username = root\n2025-06-18 15:23:14.229 INFO  org.apache.flink.configuration.Configuration(863): Config uses fallback configuration key 'rest.port' instead of key 'rest.bind-port'\n2025-06-18 15:23:14.234 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.cpu.cores required for local execution is not set, setting it to the maximal possible value.\n2025-06-18 15:23:14.234 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.task.heap.size required for local execution is not set, setting it to the maximal possible value.\n2025-06-18 15:23:14.234 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.task.off-heap.size required for local execution is not set, setting it to the maximal possible value.\n2025-06-18 15:23:14.235 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.network.min required for local execution is not set, setting it to its default value 64 mb.\n2025-06-18 15:23:14.236 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.network.max required for local execution is not set, setting it to its default value 64 mb.\n2025-06-18 15:23:14.236 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils(281): The configuration option taskmanager.memory.managed.size required for local execution is not set, setting it to its default value 128 mb.\n2025-06-18 15:23:14.242 INFO  org.apache.flink.runtime.minicluster.MiniCluster(322): Starting Flink Mini Cluster\n2025-06-18 15:23:14.622 INFO  org.apache.flink.runtime.minicluster.MiniCluster(341): Starting Metrics Registry\n2025-06-18 15:23:14.691 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl(142): No metrics reporter configured, no metrics will be exposed/reported.\n2025-06-18 15:23:14.691 INFO  org.apache.flink.runtime.minicluster.MiniCluster(348): Starting RPC Service(s)\n2025-06-18 15:23:14.705 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(225): Trying to start local actor system\n2025-06-18 15:23:14.968 INFO  akka.event.slf4j.Slf4jLogger(107): Slf4jLogger started\n2025-06-18 15:23:15.045 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(255): Actor system started at akka://flink\n2025-06-18 15:23:15.056 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(225): Trying to start local actor system\n2025-06-18 15:23:15.064 INFO  akka.event.slf4j.Slf4jLogger(107): Slf4jLogger started\n2025-06-18 15:23:15.071 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils(255): Actor system started at akka://flink-metrics\n2025-06-18 15:23:15.084 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.metrics.dump.MetricQueryService at akka://flink-metrics/user/rpc/MetricQueryService .\n2025-06-18 15:23:15.103 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(127): Loading delegation token providers\n2025-06-18 15:23:15.109 INFO  org.apache.flink.runtime.security.token.hadoop.HadoopFSDelegationTokenProvider(76): Hadoop FS is not available (not packaged with this application): NoClassDefFoundError : \"org/apache/hadoop/io/Text\".\n2025-06-18 15:23:15.109 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(135): Delegation token provider hadoopfs loaded and initialized\n2025-06-18 15:23:15.112 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(135): Delegation token provider hbase loaded and initialized\n2025-06-18 15:23:15.112 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(165): Delegation token providers loaded successfully\n2025-06-18 15:23:15.113 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(64): Loading delegation token receivers\n2025-06-18 15:23:15.116 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hadoopfs loaded and initialized\n2025-06-18 15:23:15.117 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hbase loaded and initialized\n2025-06-18 15:23:15.118 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(101): Delegation token receivers loaded successfully\n2025-06-18 15:23:15.118 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(189): Checking provider and receiver instances consistency\n2025-06-18 15:23:15.118 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(209): Provider and receiver instances are consistent\n2025-06-18 15:23:15.119 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(240): Obtaining delegation tokens\n2025-06-18 15:23:15.121 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(243): Delegation tokens obtained successfully\n2025-06-18 15:23:15.121 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(248): No tokens obtained so skipping notifications\n2025-06-18 15:23:15.121 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(64): Loading delegation token receivers\n2025-06-18 15:23:15.122 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hadoopfs loaded and initialized\n2025-06-18 15:23:15.122 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(72): Delegation token receiver hbase loaded and initialized\n2025-06-18 15:23:15.123 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository(101): Delegation token receivers loaded successfully\n2025-06-18 15:23:15.138 INFO  org.apache.flink.runtime.blob.BlobServer(164): Created BLOB server storage directory /tmp/minicluster_6ea368b166941778804d7ea99cda8bee/blobStorage\n2025-06-18 15:23:15.144 INFO  org.apache.flink.runtime.blob.BlobServer(238): Started BLOB server at 0.0.0.0:38403 - max concurrent requests: 50 - max backlog: 1000\n2025-06-18 15:23:15.154 INFO  org.apache.flink.runtime.blob.PermanentBlobCache(93): Created BLOB cache storage directory /tmp/minicluster_6ea368b166941778804d7ea99cda8bee/blobStorage\n2025-06-18 15:23:15.156 INFO  org.apache.flink.runtime.blob.TransientBlobCache(93): Created BLOB cache storage directory /tmp/minicluster_6ea368b166941778804d7ea99cda8bee/blobStorage\n2025-06-18 15:23:15.158 INFO  org.apache.flink.runtime.minicluster.MiniCluster(733): Starting 1 TaskManager(s)\n2025-06-18 15:23:15.165 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner(602): Starting TaskManager with ResourceID: cf6da506-08d4-44c5-b9cb-331b1c08c49b\n2025-06-18 15:23:15.173 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerServices(487): Temporary file directory '/tmp': total 1006 GB, usable 873 GB (86.78% usable)\n2025-06-18 15:23:15.179 INFO  org.apache.flink.runtime.io.disk.iomanager.IOManager(60): Created a new FileChannelManager for spilling of task related data to disk (joins, sorting, ...). Used directories:\n\t/tmp/flink-io-c33942cc-8673-4fb9-a126-b08b0ea68403\n2025-06-18 15:23:15.193 INFO  org.apache.flink.runtime.io.network.NettyShuffleServiceFactory(161): Created a new FileChannelManager for storing result partitions of BLOCKING shuffles. Used directories:\n\t/tmp/flink-netty-shuffle-4b569fb8-e7be-4654-9f61-65d62f536719\n2025-06-18 15:23:15.238 INFO  org.apache.flink.runtime.io.network.buffer.NetworkBufferPool(156): Allocated 64 MB for network buffer pool (number of memory segments: 2048, bytes per segment: 32768).\n2025-06-18 15:23:15.253 INFO  org.apache.flink.runtime.io.network.NettyShuffleEnvironment(353): Starting the network environment and its components.\n2025-06-18 15:23:15.256 INFO  org.apache.flink.runtime.taskexecutor.KvStateService(92): Starting the kvState service and its components.\n2025-06-18 15:23:15.276 INFO  org.apache.flink.configuration.Configuration(863): Config uses fallback configuration key 'akka.ask.timeout' instead of key 'taskmanager.slot.timeout'\n2025-06-18 15:23:15.287 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.taskexecutor.TaskExecutor at akka://flink/user/rpc/taskmanager_0 .\n2025-06-18 15:23:15.307 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(127): Start job leader service.\n2025-06-18 15:23:15.309 INFO  org.apache.flink.runtime.filecache.FileCache(116): User file cache uses directory /tmp/flink-dist-cache-851319e4-106f-438e-b90f-2dc5a79c3213\n2025-06-18 15:23:15.338 INFO  org.apache.flink.configuration.Configuration(863): Config uses fallback configuration key 'rest.port' instead of key 'rest.bind-port'\n2025-06-18 15:23:15.361 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(180): Starting rest endpoint.\n2025-06-18 15:23:15.475 WARN  org.apache.flink.runtime.webmonitor.WebMonitorUtils(76): Log file environment variable 'log.file' is not set.\n2025-06-18 15:23:15.475 WARN  org.apache.flink.runtime.webmonitor.WebMonitorUtils(82): JobManager log files are unavailable in the web dashboard. Log file location not found in environment variable 'log.file' or configuration key 'web.log.path'.\n2025-06-18 15:23:15.631 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(303): Rest endpoint listening at localhost:35792\n2025-06-18 15:23:15.632 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender http://localhost:35792\n2025-06-18 15:23:15.633 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(1034): Web frontend listening at http://localhost:35792.\n2025-06-18 15:23:15.634 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint(1092): http://localhost:35792 was granted leadership with leaderSessionID=38eb3cd0-3a2c-44fd-93ec-ddbceb769114\n2025-06-18 15:23:15.634 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader http://localhost:35792 , session=38eb3cd0-3a2c-44fd-93ec-ddbceb769114\n2025-06-18 15:23:15.651 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender LeaderContender: DefaultDispatcherRunner\n2025-06-18 15:23:15.651 INFO  org.apache.flink.runtime.resourcemanager.ResourceManagerServiceImpl(119): Starting resource manager service.\n2025-06-18 15:23:15.652 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender LeaderContender: ResourceManagerServiceImpl\n2025-06-18 15:23:15.652 INFO  org.apache.flink.runtime.dispatcher.runner.DefaultDispatcherRunner(114): DefaultDispatcherRunner was granted leadership with leader id fffeca58-a7e4-4887-94a8-c2ae5b0835d6. Creating new DispatcherLeaderProcess.\n2025-06-18 15:23:15.653 INFO  org.apache.flink.runtime.resourcemanager.ResourceManagerServiceImpl(199): Resource manager service is granted leadership with session id cb9f97ca-e940-436e-a402-89b202ad4568.\n2025-06-18 15:23:15.656 INFO  org.apache.flink.runtime.minicluster.MiniCluster(508): Flink Mini Cluster started successfully\n2025-06-18 15:23:15.659 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess(99): Start SessionDispatcherLeaderProcess.\n2025-06-18 15:23:15.662 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess(144): Recover all persisted job graphs that are not finished, yet.\n2025-06-18 15:23:15.663 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess(158): Successfully recovered 0 persisted job graphs.\n2025-06-18 15:23:15.678 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.resourcemanager.StandaloneResourceManager at akka://flink/user/rpc/resourcemanager_1 .\n2025-06-18 15:23:15.678 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.dispatcher.StandaloneDispatcher at akka://flink/user/rpc/dispatcher_2 .\n2025-06-18 15:23:15.697 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(251): Starting the resource manager.\n2025-06-18 15:23:15.717 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader akka://flink/user/rpc/dispatcher_2 , session=fffeca58-a7e4-4887-94a8-c2ae5b0835d6\n2025-06-18 15:23:15.718 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(308): Starting tokens update task\n2025-06-18 15:23:15.718 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(320): No tokens obtained so skipping notifications\n2025-06-18 15:23:15.719 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager(335): Tokens update task not started because either no tokens obtained or none of the tokens specified its renewal date\n2025-06-18 15:23:15.719 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader akka://flink/user/rpc/resourcemanager_1 , session=cb9f97ca-e940-436e-a402-89b202ad4568\n2025-06-18 15:23:15.721 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1416): Connecting to ResourceManager akka://flink/user/rpc/resourcemanager_1(a40289b202ad4568cb9f97cae940436e).\n2025-06-18 15:23:15.733 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(162): Resolved ResourceManager address, beginning registration\n2025-06-18 15:23:15.741 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(1033): Registering TaskManager with ResourceID cf6da506-08d4-44c5-b9cb-331b1c08c49b (akka://flink/user/rpc/taskmanager_0) at ResourceManager\n2025-06-18 15:23:15.745 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher(496): Received JobGraph submission 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.746 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher(599): Submitting job 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.746 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(99): Successful registration at resource manager akka://flink/user/rpc/resourcemanager_1 under registration id 72221bca282229cac5ead84d160b54b9.\n2025-06-18 15:23:15.766 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(309): Proposing leadership to contender LeaderContender: JobMasterServiceLeadershipRunner\n2025-06-18 15:23:15.767 INFO  org.apache.flink.runtime.jobmaster.JobMasterServiceLeadershipRunner(310): JobMasterServiceLeadershipRunner for job d684d51546251379fbbe534b66ccca2a was granted leadership with leader id 646f0693-74e7-4ed6-86ad-569966a034b0. Creating new JobMasterServiceProcess.\n2025-06-18 15:23:15.782 INFO  org.apache.flink.runtime.rpc.akka.AkkaRpcService(272): Starting RPC endpoint for org.apache.flink.runtime.jobmaster.JobMaster at akka://flink/user/rpc/jobmanager_3 .\n2025-06-18 15:23:15.792 INFO  org.apache.flink.runtime.jobmaster.JobMaster(314): Initializing job 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.826 INFO  org.apache.flink.runtime.jobmaster.JobMaster(103): Using restart back off time strategy NoRestartBackoffTimeStrategy for mysql-oracle (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.872 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(406): Created execution graph 171ab47548f91c2f2151721d23b39dfc for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:15.903 INFO  org.apache.flink.runtime.jobmaster.JobMaster(165): Running initialization on master for job mysql-oracle (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:15.904 INFO  org.apache.flink.runtime.jobmaster.JobMaster(194): Successfully ran initialization on master in 1 ms.\n2025-06-18 15:23:15.955 INFO  org.apache.flink.runtime.scheduler.adapter.DefaultExecutionTopology(416): Built 1 new pipelined regions in 2 ms, total 1 pipelined regions currently.\n2025-06-18 15:23:15.961 INFO  org.apache.flink.runtime.jobmaster.JobMaster(263): No state backend has been configured, using default (HashMap) org.apache.flink.runtime.state.hashmap.HashMapStateBackend@2d711b25\n2025-06-18 15:23:15.962 INFO  org.apache.flink.runtime.state.StateBackendLoader(321): State backend loader loads the state backend as HashMapStateBackend\n2025-06-18 15:23:15.964 INFO  org.apache.flink.runtime.jobmaster.JobMaster(274): Checkpoint storage is set to 'jobmanager'\n2025-06-18 15:23:16.001 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator(1706): No checkpoint found during restore.\n2025-06-18 15:23:16.014 INFO  org.apache.flink.runtime.jobmaster.JobMaster(164): Using failover strategy org.apache.flink.runtime.executiongraph.failover.flip1.RestartPipelinedRegionFailoverStrategy@6e785df6 for mysql-oracle (d684d51546251379fbbe534b66ccca2a).\n2025-06-18 15:23:16.027 INFO  org.apache.flink.runtime.highavailability.nonha.embedded.EmbeddedLeaderService(257): Received confirmation of leadership for leader akka://flink/user/rpc/jobmanager_3 , session=646f0693-74e7-4ed6-86ad-569966a034b0\n2025-06-18 15:23:16.031 INFO  org.apache.flink.runtime.jobmaster.JobMaster(955): Starting execution of job 'mysql-oracle' (d684d51546251379fbbe534b66ccca2a) under job master id 86ad569966a034b0646f069374e74ed6.\n2025-06-18 15:23:16.035 INFO  org.apache.flink.runtime.source.coordinator.SourceCoordinator(201): Starting split enumerator for source Source: table1[1].\n2025-06-18 15:23:16.052 INFO  org.apache.flink.cdc.connectors.mysql.source.connection.JdbcConnectionPools(49): Create and register connection pool root@60.205.169.125:3306\n2025-06-18 15:23:16.060 INFO  org.apache.flink.cdc.connectors.shaded.com.zaxxer.hikari.HikariDataSource(80): connection-pool-60.205.169.125:3306 - Starting...\n2025-06-18 15:23:16.403 INFO  org.apache.flink.cdc.connectors.shaded.com.zaxxer.hikari.HikariDataSource(82): connection-pool-60.205.169.125:3306 - Start completed.\n2025-06-18 15:23:16.527 INFO  io.debezium.jdbc.JdbcConnection(962): Connection gracefully closed\n2025-06-18 15:23:16.528 INFO  org.apache.flink.cdc.connectors.mysql.MySqlValidator(81): MySQL validation passed.\n2025-06-18 15:23:16.624 INFO  io.debezium.jdbc.JdbcConnection(962): Connection gracefully closed\n2025-06-18 15:23:16.628 INFO  org.apache.flink.runtime.jobmaster.JobMaster(212): Starting scheduling with scheduling strategy [org.apache.flink.runtime.scheduler.strategy.PipelinedRegionSchedulingStrategy]\n2025-06-18 15:23:16.628 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1165): Job mysql-oracle (d684d51546251379fbbe534b66ccca2a) switched from state CREATED to RUNNING.\n2025-06-18 15:23:16.632 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to SCHEDULED.\n2025-06-18 15:23:16.653 INFO  org.apache.flink.runtime.jobmaster.JobMaster(1150): Connecting to ResourceManager akka://flink/user/rpc/resourcemanager_1(a40289b202ad4568cb9f97cae940436e)\n2025-06-18 15:23:16.656 INFO  org.apache.flink.runtime.jobmaster.JobMaster(162): Resolved ResourceManager address, beginning registration\n2025-06-18 15:23:16.658 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(388): Registering job manager 86ad569966a034b0646f069374e74ed6@akka://flink/user/rpc/jobmanager_3 for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.662 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager(968): Registered job manager 86ad569966a034b0646f069374e74ed6@akka://flink/user/rpc/jobmanager_3 for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.663 INFO  org.apache.flink.runtime.jobmaster.JobMaster(1174): JobManager successfully registered at ResourceManager, leader id: a40289b202ad4568cb9f97cae940436e.\n2025-06-18 15:23:16.666 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DeclarativeSlotManager(295): Received resource requirements from job d684d51546251379fbbe534b66ccca2a: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]\n2025-06-18 15:23:16.704 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(52): Read list of available databases\n2025-06-18 15:23:16.726 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(65): \t list of available databases is: [test]\n2025-06-18 15:23:16.727 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(74): Read list of available tables in each database\n2025-06-18 15:23:16.734 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1113): Receive slot request a46332115ff2d6c1e1e2b1577664e424 for job d684d51546251379fbbe534b66ccca2a from resource manager with leader id a40289b202ad4568cb9f97cae940436e.\n2025-06-18 15:23:16.741 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1208): Allocated slot for a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.744 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(192): Add job d684d51546251379fbbe534b66ccca2a for job leader monitoring.\n2025-06-18 15:23:16.746 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(86): \t including table 'test.table1' for further processing\n2025-06-18 15:23:16.746 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(90): \t 'test.table2' is filtered out of table capturing\n2025-06-18 15:23:16.746 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(90): \t 'test.table3' is filtered out of table capturing\n2025-06-18 15:23:16.747 INFO  org.apache.flink.cdc.connectors.mysql.source.utils.TableDiscoveryUtils(90): \t 'test.table4' is filtered out of table capturing\n2025-06-18 15:23:16.747 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(350): Try to register at job manager akka://flink/user/rpc/jobmanager_3 with leader id 646f0693-74e7-4ed6-86ad-569966a034b0.\n2025-06-18 15:23:16.749 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(162): Resolved JobManager address, beginning registration\n2025-06-18 15:23:16.755 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService(417): Successful registration at job manager akka://flink/user/rpc/jobmanager_3 for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.756 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1720): Establish JobManager connection for job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.762 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(1571): Offer reserved slots to the leader of job d684d51546251379fbbe534b66ccca2a.\n2025-06-18 15:23:16.769 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from SCHEDULED to DEPLOYING.\n2025-06-18 15:23:16.770 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(561): Deploying Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (attempt #0) with attempt id 171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to cf6da506-08d4-44c5-b9cb-331b1c08c49b @ localhost (dataPort=-1) with allocation id a46332115ff2d6c1e1e2b1577664e424\n2025-06-18 15:23:16.777 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl(388): Activate slot a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.791 INFO  io.debezium.jdbc.JdbcConnection(962): Connection gracefully closed\n2025-06-18 15:23:16.793 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlSnapshotSplitAssigner(297): Start splitting table test.table1 into chunks...\n2025-06-18 15:23:16.796 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader(84): StateChangelogStorageLoader initialized with shortcut names {memory,filesystem}.\n2025-06-18 15:23:16.796 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader(106): Creating a changelog storage with name 'memory'.\n2025-06-18 15:23:16.813 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager(70): Creating the channel state executor factory for job id d684d51546251379fbbe534b66ccca2a\n2025-06-18 15:23:16.827 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor(789): Received task Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0), deploy into slot with allocation id a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.829 INFO  org.apache.flink.runtime.taskmanager.Task(1084): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to DEPLOYING.\n2025-06-18 15:23:16.831 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl(388): Activate slot a46332115ff2d6c1e1e2b1577664e424.\n2025-06-18 15:23:16.834 INFO  org.apache.flink.runtime.taskmanager.Task(622): Loading JAR files for task Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) [DEPLOYING].\n2025-06-18 15:23:16.858 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask(263): No state backend has been configured, using default (HashMap) org.apache.flink.runtime.state.hashmap.HashMapStateBackend@6bba90d4\n2025-06-18 15:23:16.859 INFO  org.apache.flink.runtime.state.StateBackendLoader(321): State backend loader loads the state backend as HashMapStateBackend\n2025-06-18 15:23:16.859 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask(274): Checkpoint storage is set to 'jobmanager'\n2025-06-18 15:23:16.872 INFO  org.apache.flink.runtime.taskmanager.Task(1084): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.\n2025-06-18 15:23:16.875 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.\n2025-06-18 15:23:17.481 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlChunkSplitter(165): Use unevenly-sized chunks for table test.table1, the chunk size is 8096 from null\n2025-06-18 15:23:17.609 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlChunkSplitter(470): ChunkSplitter has split 0 chunks for table test.table1\n2025-06-18 15:23:17.610 INFO  org.apache.flink.cdc.connectors.mysql.source.assigners.MySqlSnapshotSplitAssigner(331): Split table test.table1 into 1 chunks, time cost: 817ms.\n2025-06-18 15:23:17.912 INFO  org.apache.flink.runtime.source.coordinator.SourceCoordinator(594): Source Source: table1[1] registering reader for parallel task 0 (#0) @ \n2025-06-18 15:23:17.914 INFO  org.apache.flink.runtime.source.coordinator.SourceCoordinator(555): Source Source: table1[1] received split request from parallel task 0 (#0)\n2025-06-18 15:23:17.915 INFO  org.apache.flink.runtime.taskmanager.Task(1084): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1)#0 (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to RUNNING.\n2025-06-18 15:23:17.915 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph(1438): Source: table1[1] -> DropUpdateBefore[2] -> ConstraintEnforcer[3] -> Sink: TEST_MYSQL[3] (1/1) (171ab47548f91c2f2151721d23b39dfc_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to RUNNING.\n2025-06-18 15:23:17.945 INFO  org.apache.flink.cdc.connectors.mysql.source.enumerator.MySqlSourceEnumerator(229): The enumerator assigns split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null} to subtask 0\n2025-06-18 15:23:17.967 INFO  org.apache.flink.cdc.connectors.mysql.source.reader.MySqlSourceReader(235): Source reader 0 adds split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}\n2025-06-18 15:23:17.967 INFO  org.apache.flink.connector.base.source.reader.SourceReaderBase(235): Adding split(s) to reader: [MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}]\n2025-06-18 15:23:17.973 INFO  org.apache.flink.connector.base.source.reader.fetcher.SplitFetcher(112): Starting split fetcher 0\n2025-06-18 15:23:17.974 INFO  org.apache.flink.cdc.connectors.mysql.source.reader.MySqlSplitReader(215): Handling split change SplitAddition:[[MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}]]\n2025-06-18 15:23:17.979 WARN  io.debezium.connector.mysql.MySqlConnection(643): Database configuration option 'serverTimezone' is set but is obsolete, please use 'connectionTimeZone' instead\n2025-06-18 15:23:18.194 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.context.StatefulTaskContext(200): Starting offset is initialized to {ts_sec=0, file=, pos=0, kind=EARLIEST, row=0, event=0}\n2025-06-18 15:23:18.279 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(157): Snapshot step 1 - Determining low watermark {ts_sec=0, file=mysql-bin.000044, pos=154, kind=SPECIFIC, gtids=, row=0, event=0} for split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}\n2025-06-18 15:23:18.284 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(170): Snapshot step 2 - Snapshotting data\n2025-06-18 15:23:18.284 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(243): Exporting data from split 'test.table1:0' of table test.table1\n2025-06-18 15:23:18.284 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(251): For split 'test.table1:0' of table test.table1 using select statement: 'SELECT * FROM `test`.`table1`'\n2025-06-18 15:23:18.333 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(298): Finished exporting 2 records for split 'test.table1:0', total duration '00:00:00.049'\n2025-06-18 15:23:18.354 INFO  org.apache.flink.cdc.connectors.mysql.debezium.task.MySqlSnapshotSplitReadTask(192): Snapshot step 3 - Determining high watermark {ts_sec=0, file=mysql-bin.000044, pos=154, kind=SPECIFIC, gtids=, row=0, event=0} for split MySqlSnapshotSplit{tableId=test.table1, splitId='test.table1:0', splitKeyType=[`id` VARCHAR(255) NOT NULL], splitStart=null, splitEnd=null, highWatermark=null}\n2025-06-18 15:23:18.490 INFO  org.dinky.service.impl.TaskServiceImpl(195): execute job finished,status is SUCCESS\nProcess Step SUBMIT_EXECUTE exit with status:FINISHED\n",
            children: [
              {
                label: "构建配置信息",
                log: "Start Process Step:SUBMIT_BUILD_CONFIG\n2025-06-18 15:23:10.211 INFO  org.dinky.service.impl.TaskServiceImpl(289): Start initialize FlinkSQLEnv:\n2025-06-18 15:23:10.212 INFO  org.dinky.service.impl.TaskServiceImpl(309): Initializing data permissions...\n2025-06-18 15:23:10.358 INFO  org.dinky.service.impl.TaskServiceImpl(311): Finish initialize FlinkSQLEnv.\n2025-06-18 15:23:10.362 INFO  org.dinky.service.impl.TaskServiceImpl(239): Init remote cluster\nProcess Step SUBMIT_BUILD_CONFIG exit with status:FINISHED\n",
              },
            ],
          },
        ],
      },
    ],
  },
  {
    name: "查询结果",
    type: "result",
    icon: "Odometer",
    data: [],
  },
  {
    name: "执行历史记录",
    type: "history",
    icon: "Timer",
    data: [],
  },
]);
const activeValue = ref({ name: "" });
const handleIcon = (item) => {
  if (activeValue.value.name == item.name) {
    activeValue.value = { name: "" };
  } else {
    activeValue.value = item;
  }
};
const closeConsoleDialog = () => {
  activeValue.value = { name: "" };
};
// 右侧图标
const iconListR = ref([
  {
    name: "属性配置",
    type: "attrConfig",
    icon: "Setting",
    data: {},
  },
]);
iconListR.value[0] = { ...iconListR.value[0], ...props.configValue };
const activeValueR = ref(iconListR.value[0]);
const handleIconR = (item) => {
  if (activeValueR.value.name == item.name) {
    activeValueR.value = { name: "" };
  } else {
    activeValueR.value = item;
  }
};
const closeConsoleDialogR = () => {
  activeValueR.value = { name: "" };
};
// 控制台和配置页的自定义宽高
const consoleRef = ref(null);
const consoleHeight = computed(() => consoleRef.value && consoleRef.value.currHeight);
const configViewRef = ref(null);
const configWidth = computed(() => configViewRef.value && configViewRef.value.currWidth);

// 全屏
const editorMain = ref(null);
const { isFullscreen, toggle } = useFullscreen(editorMain);
const fullScreenCallBack = () => {
  toggle();
};

const handleChange = (value) => {
  emits("handleChange", value);
};
</script>
<style lang="scss" scoped>
.editor-warp {
  width: 100%;
  height: 100%;
  position: relative;
  padding: 15px 0px 15px 0px;
  background: #F9F9F9;
  display: flex;

  .sideConfig {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 0 4px;

    .icon {
      font-size: 16px;
      padding: 6px;
      border-radius: 6px;
      margin-top: 4px;

      &:hover {
        background-color: #e6f7ff;
      }

      &.act {
        background-color: #e6f7ff;
      }
    }

    &.sideConfig-r {
      justify-content: flex-start;

      .icon {
        margin-top: 0px;
        margin-bottom: 4px;
      }
    }
  }

  .editor-con {
    width: 100%;
    height: 100%;

    .editor-main {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;

      .json-editor {
        border-bottom: none;
      }
    }
  }
}

.full-screen {
  cursor: pointer;
  position: absolute;
  top: 30px;
  right: 10%;
  z-index: 10;
  box-shadow: rgb(204, 204, 204) 0px 0px 10px;
  padding: 0px 5px;
  border-radius: 4px;
}
</style>
